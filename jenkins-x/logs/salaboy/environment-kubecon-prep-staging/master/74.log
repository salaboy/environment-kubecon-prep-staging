
Showing logs for build [32msalaboy-environment-kubecon-pre-mwm6b-74[0m stage [32mfrom-build-pack[0m and container [32mstep-credential-initializer-jwvm9[0m
{"level":"warn","ts":1583233324.779046,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: \"ref: refs/heads/0.8.0-**-support-backwards-incompats\" is not a valid GitHub commit ID"}
{"level":"info","ts":1583233324.7797675,"logger":"fallback-logger","caller":"creds-init/main.go:40","msg":"Credentials initialized."}

Showing logs for build [32msalaboy-environment-kubecon-pre-mwm6b-74[0m stage [32mfrom-build-pack[0m and container [32mstep-working-dir-initializer-qcwz7[0m
{"level":"warn","ts":1583233326.089709,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: open /var/run/ko/HEAD: no such file or directory"}
{"level":"info","ts":1583233326.0960345,"logger":"fallback-logger","caller":"bash/main.go:64","msg":"Successfully executed command \"sh -c mkdir -p /workspace/source\"; output "}

Showing logs for build [32msalaboy-environment-kubecon-pre-mwm6b-74[0m stage [32mfrom-build-pack[0m and container [32mstep-place-tools[0m

Showing logs for build [32msalaboy-environment-kubecon-pre-mwm6b-74[0m stage [32mfrom-build-pack[0m and container [32mstep-git-source-salaboy-environment-kubecon-pre-mwm6b-jfzz9[0m
{"level":"warn","ts":1583233336.7774038,"logger":"fallback-logger","caller":"logging/config.go:69","msg":"Fetch GitHub commit ID from kodata failed: \"ref: refs/heads/0.8.0-**-support-backwards-incompats\" is not a valid GitHub commit ID"}
{"level":"info","ts":1583233338.4036195,"logger":"fallback-logger","caller":"git/git.go:103","msg":"Successfully cloned https://github.com/*******/environment-kubecon-prep-staging.git @ v0.0.72 in path /workspace/source"}

Showing logs for build [32msalaboy-environment-kubecon-pre-mwm6b-74[0m stage [32mfrom-build-pack[0m and container [32mstep-git-merge[0m
Using SHAs from PULL_REFS=master:c16ebe61305c66db1716e0787a8411aa892f73a3
WARNING: no SHAs to merge, falling back to initial cloned commit

Showing logs for build [32msalaboy-environment-kubecon-pre-mwm6b-74[0m stage [32mfrom-build-pack[0m and container [32mstep-setup-jx-git-credentials[0m
Generated Git credentials file /builder/home/git/credentials

Showing logs for build [32msalaboy-environment-kubecon-pre-mwm6b-74[0m stage [32mfrom-build-pack[0m and container [32mstep-build-helm-apply[0m
Modified file /workspace/source/env/Chart.yaml to set the chart to version 74
Ignoring templates/.gitignore
Ignoring templates/wildcardcert-secret.yaml
WARNING: No $CHART_REPOSITORY defined so using the default value of: http://jenkins-x-chartmuseum:8080
Adding missing Helm repo: storage.googleapis.com https://storage.googleapis.com/chartmuseum.jenkins-x.io
Successfully added Helm repository storage.googleapis.com.
Adding missing Helm repo: jenkins-x-chartmuseum http://jenkins-x-chartmuseum:8080
Successfully added Helm repository jenkins-x-chartmuseum.
WARNING: No $CHART_REPOSITORY defined so using the default value of: http://jenkins-x-chartmuseum:8080
Adding missing Helm repo: chartmuseum.jenkins-x.io http://chartmuseum.jenkins-x.io
Successfully added Helm repository chartmuseum.jenkins-x.io.
error: upgrading helm chart '.': failed to run 'kubectl apply --recursive -f /tmp/helm-template-workdir-118226747/**/output/namespaces/**-staging -l jenkins.io/chart-release=** --namespace **-staging --wait --validate=false' command in directory '/tmp/**-helm-apply-157183019/env', output: 'rolebinding.rbac.authorization.k8s.io/cleanup configured
serviceaccount/cleanup created
configmap/exposecontroller created
role.rbac.authorization.k8s.io/expose created
serviceaccount/expose created
deployment.apps/**-fmtok8s-agenda created
release.jenkins.io/fmtok8s-agenda-0.0.10 created
service/fmtok8s-agenda created
deployment.apps/**-fmtok8s-api-gateway created
release.jenkins.io/fmtok8s-api-gateway-0.0.34 created
service/fmtok8s-api-gateway created
deployment.apps/**-fmtok8s-c4p created
release.jenkins.io/fmtok8s-c4p-0.0.19 created
service/fmtok8s-c4p created
deployment.apps/**-fmtok8s-email created
release.jenkins.io/fmtok8s-email-0.0.6 created
service/fmtok8s-email created
deployment.apps/**-fmtok8s-monolith created
release.jenkins.io/fmtok8s-monolith-0.0.1 created
service/fmtok8s-monolith created
cronjob.batch/**-integration-test created
release.jenkins.io/fmtok8s-tests-0.0.7 created
Error from server (NotFound): error when applying patch:
{"metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"Role\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"**\",\"jenkins.io/namespace\":\"**-staging\",\"jenkins.io/version\":\"74\"},\"name\":\"cleanup\",\"namespace\":\"**-staging\"},\"rules\":[{\"apiGroups\":[\"extensions\"],\"resources\":[\"ingresses\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"configmaps\",\"services\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"extensions\",\"apps\"],\"resources\":[\"deployments\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"\",\"route.openshift.io\"],\"resources\":[\"routes\",\"routes/custom-host\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]}]}\n"},"labels":{"jenkins.io/version":"74"}}}
to:
Resource: "rbac.authorization.k8s.io/v1, Resource=roles", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=Role"
Name: "cleanup", Namespace: "**-staging"
Object: &{map["apiVersion":"rbac.authorization.k8s.io/v1" "kind":"Role" "metadata":map["annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"Role\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"**\",\"jenkins.io/namespace\":\"**-staging\",\"jenkins.io/version\":\"73\"},\"name\":\"cleanup\",\"namespace\":\"**-staging\"},\"rules\":[{\"apiGroups\":[\"extensions\"],\"resources\":[\"ingresses\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]},{\"apiGroups\":[\"\"],\"resources\":[\"configmaps\",\"services\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"extensions\",\"apps\"],\"resources\":[\"deployments\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"update\"]},{\"apiGroups\":[\"\",\"route.openshift.io\"],\"resources\":[\"routes\",\"routes/custom-host\"],\"verbs\":[\"get\",\"list\",\"watch\",\"patch\",\"create\",\"update\",\"delete\"]}]}\n"] "creationTimestamp":"2020-02-19T10:35:50Z" "labels":map["jenkins.io/chart-release":"**" "jenkins.io/namespace":"**-staging" "jenkins.io/version":"73"] "name":"cleanup" "namespace":"**-staging" "resourceVersion":"5659073" "selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/**-staging/roles/cleanup" "uid":"97ea9f93-ea32-43fe-ac4e-55ad450762ac"] "rules":[map["apiGroups":["extensions"] "resources":["ingresses"] "verbs":["get" "list" "watch" "patch" "create" "update" "delete"]] map["apiGroups":[""] "resources":["configmaps" "services"] "verbs":["get" "list" "watch" "patch" "update"]] map["apiGroups":["extensions" "apps"] "resources":["deployments"] "verbs":["get" "list" "watch" "patch" "update"]] map["apiGroups":["" "route.openshift.io"] "resources":["routes" "routes/custom-host"] "verbs":["get" "list" "watch" "patch" "create" "update" "delete"]]]]}
for: "/tmp/helm-template-workdir-118226747/**/output/namespaces/**-staging/env/charts/cleanup/templates/part0-role.yaml": roles.rbac.authorization.k8s.io "cleanup" not found
Error from server (NotFound): error when applying patch:
{"metadata":{"annotations":{"kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"RoleBinding\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"**\",\"jenkins.io/namespace\":\"**-staging\",\"jenkins.io/version\":\"74\"},\"name\":\"expose\",\"namespace\":\"**-staging\"},\"roleRef\":{\"apiGroup\":\"rbac.authorization.k8s.io\",\"kind\":\"Role\",\"name\":\"expose\"},\"subjects\":[{\"kind\":\"ServiceAccount\",\"name\":\"expose\",\"namespace\":\"**-staging\"}]}\n"},"labels":{"jenkins.io/version":"74"}}}
to:
Resource: "rbac.authorization.k8s.io/v1, Resource=rolebindings", GroupVersionKind: "rbac.authorization.k8s.io/v1, Kind=RoleBinding"
Name: "expose", Namespace: "**-staging"
Object: &{map["apiVersion":"rbac.authorization.k8s.io/v1" "kind":"RoleBinding" "metadata":map["annotations":map["jenkins.io/chart":"env" "kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"rbac.authorization.k8s.io/v1\",\"kind\":\"RoleBinding\",\"metadata\":{\"annotations\":{\"jenkins.io/chart\":\"env\"},\"labels\":{\"jenkins.io/chart-release\":\"**\",\"jenkins.io/namespace\":\"**-staging\",\"jenkins.io/version\":\"73\"},\"name\":\"expose\",\"namespace\":\"**-staging\"},\"roleRef\":{\"apiGroup\":\"rbac.authorization.k8s.io\",\"kind\":\"Role\",\"name\":\"expose\"},\"subjects\":[{\"kind\":\"ServiceAccount\",\"name\":\"expose\",\"namespace\":\"**-staging\"}]}\n"] "creationTimestamp":"2020-02-19T10:35:50Z" "labels":map["jenkins.io/chart-release":"**" "jenkins.io/namespace":"**-staging" "jenkins.io/version":"73"] "name":"expose" "namespace":"**-staging" "resourceVersion":"5659084" "selfLink":"/apis/rbac.authorization.k8s.io/v1/namespaces/**-staging/rolebindings/expose" "uid":"58707417-bfab-49a6-ab66-380bf5e6fbce"] "roleRef":map["apiGroup":"rbac.authorization.k8s.io" "kind":"Role" "name":"expose"] "subjects":[map["kind":"ServiceAccount" "name":"expose" "namespace":"**-staging"]]]}
for: "/tmp/helm-template-workdir-118226747/**/output/namespaces/**-staging/env/charts/expose/templates/part0-rolebinding.yaml": rolebindings.rbac.authorization.k8s.io "expose" not found'
[31m
Pipeline failed on stage 'from-build-pack' : container 'step-build-helm-apply'. The execution of the pipeline has stopped.[0m
